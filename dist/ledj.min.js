!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ledj",[],t):"object"==typeof exports?exports.ledj=t():e.ledj=t()}(this,function(){return function(e){function t(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var a={};return t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=a(1),c=(n(o),a(2));n(c)},function(e,t,a){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"undefined"==typeof Ledj?e.Ledj=function(){function t(e,t){h.getJSONConfig(e,function(a,n){null===a&&(n.hasOwnProperty("config")&&n.hasOwnProperty("data")?(h.cache.curCacheID=h.cache.jsonConfig.push(n.config)-1,h.cache.jsonData[h.cache.curCacheID]=n.data,h.cache.jsonUrl[h.cache.curCacheID]=e,t(h.cache.curCacheID)):a="JSON data must have `config` and `data` properties."),null!==a&&console.warn('Config file "'+e+'" could not be retrieved. '+a)})}function a(e,t){e.hasOwnProperty("config")&&e.hasOwnProperty("data")?(h.cache.curCacheID=h.cache.jsonConfig.push(e.config)-1,h.cache.jsonData[h.cache.curCacheID]=e.data,t(h.cache.curCacheID)):console.warn("Config object must have `config` and `data` properties.")}function o(e,t){if(h.cache.jsonData[e])if(Array.isArray(h.cache.jsonData[e]))h.cache.jsonData[e]=_.sortBy(h.cache.jsonData[e],"string"==typeof t?t.toLowerCase():t);else if("object"===n(h.cache.jsonData[e]))for(var a in h.cache.jsonData[e])h.cache.jsonData[e][a]=_.sortBy(h.cache.jsonData[e][a],"string"==typeof t?t.toLowerCase():t);else console.warn("Could not sort cache.jsonData["+e+"]");else console.warn("from Ledj.sortJsonDataBy(): `cache.jsonData["+e+"]` does not exist.")}function c(e){o(e,h.defaults.sortDataBy)}function r(e,t){var a={cacheID:e,objectKey:t,itemHrefKey:"href",newTab:!0,itemImageKey:"filename",itemTitleKey:"title"};return l(h.templates.linkGrid(a),e,t)}function s(e,t){var a={cacheID:e,objectKey:t};return l(h.templates.table(a),e,t)}function i(e,t){var a={cacheID:e,objectKey:t};return l(h.templates.gifGrid(a),e,t)}function l(e,t,a){return h.templates.parent({title:f(t,a),cacheID:t,childHTML:e})}function d(e,t){var a=document.getElementById(t);if(a){h.cache.elementID[e]=t;var o=null;switch(h.cache.jsonConfig[e].type.toLowerCase()){case"link-grid":case"linkgrid":o=r;break;case"table":o=s;break;case"gif-grid":case"gifgrid":o=i;break;default:console.log("A fallback template is not yet implemented.")}if(o){var c="";if(Array.isArray(h.cache.jsonData[e]))c=o(e);else if("object"===n(h.cache.jsonData[e]))for(var l in h.cache.jsonData[e])c+=o(e,l);else console.warn("Couldn't find a template to use - Ledj shouldn't get here");""!==c&&(a.innerHTML+=c,h.cache.tagTemplateUsed&&(h.removeTagClickListeners(),h.addTagClickListeners()))}else console.warn("A template could not be identified.")}else console.warn("Element "+(t?"#"+t:"[undefined]")+" does not exist.")}function f(e,t){if(t&&""!==t){var a="h2";return h.cache.jsonConfig[e].hasOwnProperty("titleElementLevel")&&"number"==typeof parseInt(h.cache.jsonConfig[e].titleElementLevel)&&(a="h"+h.cache.jsonConfig[e].titleElementLevel),"<"+a+' class="ledj-title">'+t+"</"+a+">"}return null}function u(e){try{document.getElementById(e).innerHTML=""}catch(e){console.warn(e)}}function m(e,t){h.cache.tagTemplateUsed=!1,c(e),d(e,t)}var h={};return h.cache={jsonConfig:[],jsonData:[],jsonUrl:[],elementID:[],curCacheID:-1,tagTemplateUsed:!1},h.defaults={sortDataBy:"title",dateFormat:"mm/dd/yyyy",selectMultipleTags:!0},h.templates={parent:_.template('<div class="ledj-container" id="ledj-container-<%= cacheID %>"><% if(title) { print(title); } %><%= childHTML %></div>'),linkGrid:_.template('<div class="ledj-link-grid"><% (objectKey ? Ledj.cache.jsonData[cacheID][objectKey] : Ledj.cache.jsonData[cacheID]).forEach(function(dataItem) { %><a class="link-grid-item" href="<%= dataItem[itemHrefKey] %>"<% if(newTab) { %> target="_blank" <% } %>><img src="<%= Ledj.getImageUrl(dataItem[itemImageKey], cacheID, objectKey) %>" title="<%= dataItem[itemTitleKey] %>" /><span><%= dataItem[itemTitleKey] %></span></a><% }); %></div>'),table:_.template('<table class="ledj-table"><thead><tr><% _.forEach(Ledj.cache.jsonConfig[cacheID].headers, function(colConfig) { %><th><%= colConfig.name %></th><% }); %></tr></thead><tbody><% (objectKey ? Ledj.cache.jsonData[cacheID][objectKey] : Ledj.cache.jsonData[cacheID]).forEach(function(dataItem) { %><tr><% _.forEach(Ledj.cache.jsonConfig[cacheID].headers, function(colConfig, colName) { %><td><%= Ledj.getCellContent(colConfig, colName, dataItem) %></td><% }); %></tr><% }); %></tbody></table>'),gifGrid:_.template("<code>#todo</code>"),todoList:_.template("<code>#todo</code>"),data:{url:_.template('<a href="<%= href %>" target="_blank"><%= text %></a>'),image:_.template('<img class="image" src="<%= Ledj.getImageUrl(src, cacheID, objectKey) %>"<% if(alt) { print(\' alt="\' + alt + \'"\'); } %> />'),date:_.template('<span class="date"><%= Ledj.formatDateString(date, dateFormat) %></span>'),string:_.template('<span class="string"><%= text %></span>'),tagArray:_.template('<div class="tag-container"><% _.forEach(tags, function(tag) { %><span class="tag <%= Ledj.nameToID(tag) %>"><%= tag %></span><% }); %></div>')}},h.urlExists=function(e,t,a,n){var o=new XMLHttpRequest;o.open("HEAD",e),o.onreadystatechange=function(){if(this.readyState===this.DONE)if(200===this.status){if(null===t)return 0;t(n)}else{if(null===a)return-1;a(n)}},o.send()},h.reset=function(e){u(h.cache.elementID[e])},h.getJSONConfig=function(e,t){if("string"==typeof e){e+="?dt="+Date.now();var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="json",a.onload=function(){var e=a.status;200===e?t(null,a.response):t(e)},a.send()}else t("[url] must be a string.")},h.getHostName=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")},h.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},h.nameToID=function(e){return e.replace(/\\s/g,"-").toLowerCase()},h.formatDateString=function(t,a){if(e.moment){var n=moment(t),a=a||h.defaults.dateFormat;return n.format(a)}var o=new Date(t);return o.getMonth()+"/"+o.getDate()+"/"+o.getFullYear()},h.toggleActiveTagsByClassName=function(e){var t=e.target.className.replace("tag","").replace("active","").trim();h.defaults.selectMultipleTags?_.map(document.getElementsByClassName(t),function(e){e.className.includes("active")?e.className="tag "+t:e.className="tag active "+t}):_.map(document.getElementsByClassName("tag"),function(e){var a=e.className.split(" ");a.includes(t)&&!a.includes("active")?e.className="tag active "+t:e.className=e.className.replace("active","").trim()})},h.addTagClickListeners=function(){_.map(document.getElementsByClassName("tag"),function(e){e.addEventListener("click",h.toggleActiveTagsByClassName)})},h.removeTagClickListeners=function(){_.map(document.getElementsByClassName("tag"),function(e){e.removeEventListener("click",h.toggleActiveTagsByClassName)})},h.getCellContent=function(e,t,a){var n="";switch(e.type.toLowerCase()){case"url":n+=h.templates.data.url({text:a[t],href:a[e.href]});break;case"image":n+=h.templates.data.image({src:a[e.src],alt:a[e.alt]});break;case"date":var o=e.hasOwnProperty("dateFormat")?e.dateFormat:null;n+=h.templates.data.date({date:a[t],dateFormat:o});break;case"tag-array":case"tagarray":h.cache.tagTemplateUsed=!0,n+=h.templates.data.tagArray({tags:a[t]});break;case"string":default:n+=h.templates.data.string({text:a[t]})}return n},h.getImageUrl=function(e,t,a){var n="/",o=h.cache.jsonConfig[t].hasOwnProperty("imgExt")?h.cache.jsonConfig[t].imgExt:"";return h.cache.jsonConfig[t].hasOwnProperty("srcDir")?n=h.cache.jsonConfig[t].srcDir:h.cache.jsonConfig[t].hasOwnProperty("srcDirs")&&(a&&h.cache.jsonConfig[t].srcDirs.hasOwnProperty(a)?n=h.cache.jsonConfig[t].srcDirs[a]:h.cache.jsonConfig[t].srcDirs.hasOwnProperty("Default")?n=h.cache.jsonConfig[t].srcDirs.Default:h.cache.jsonConfig[t].srcDirs.hasOwnProperty("default")&&(n=h.cache.jsonConfig[t].srcDirs.default)),n+e+o},h.loadAndAttachTo=function(e,a){t(e,function(e){m(e,a)})},h.loadFromObjAndAttachTo=function(e,t){a(e,function(e){c(e),d(e,t)})},h.reloadFromUrlByID=function(e){var t=parseInt(e);"number"==typeof t&&this.cache.jsonUrl[t]&&this.cache.elementID[t]?(this.reset(t),this.loadAndAttachTo(this.cache.jsonUrl[t],this.cache.elementID[t])):console.log("Could not reload: cacheID "+e+" is invalid.")},h.reloadFromObjByID=function(e,t){var a=parseInt(t);"number"==typeof a&&this.cache.elementID[a]?(this.reset(a),this.loadFromObjAndAttachTo(e,this.cache.elementID[a])):console.log("Could not reload: cacheID "+t+" is invalid.")},h.attach=h.loadAndAttachTo,h.attachWith=h.loadFromObjAndAttachTo,h.reload=h.reloadFromUrlByID,h.reloadwith=h.reloadFromObjByID,h}():console.log("Ledj is already defined.")}(window)},function(e,t){}])});